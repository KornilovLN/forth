include lib_common.fs

: FORMAT-DATETIME ( -- addr u )
    PAD
    S" data: " PAD SWAP CMOVE
    PAD 6 +                   \ текущая позиция в буфере после "data: "
    
    TIME&DATE                 \ получаем год месяц день час мин сек
    
    >R >R >R >R >R            \ сохраняем сек мин час день месяц на стеке возврата
    0 <# # # # # #> ROT SWAP CMOVE  \ добавляем год (4 цифры)
    R> 2 + 
    [CHAR] - OVER C! 1+       \ добавляем "-"
    R> .2DIGITS               \ добавляем месяц
    [CHAR] - OVER C! 1+       \ добавляем "-"
    R> .2DIGITS               \ добавляем день
    BL OVER C! 1+             \ добавляем пробел
    R> .2DIGITS               \ добавляем час
    [CHAR] : OVER C! 1+       \ добавляем ":"
    R> .2DIGITS               \ добавляем минуты
    [CHAR] : OVER C! 1+       \ добавляем ":"
    .2DIGITS                  \ добавляем секунды
    
    PAD 25                    \ возвращаем адрес и длину строки
;

\ Простая версия форматирования текущей даты и времени
: PRINT-DATE-TIME ( -- )
    ." data: "
    TIME&DATE    \ -- год месяц день час мин сек
    
    \ Выводим дату в формате ДД-ММ-ГГГГ
    ROT .2DIGITS  \ день
    ." -"
    ROT .2DIGITS  \ месяц
    ." -"
    .            \ год
    
    ."  "        \ пробел между датой и временем
    
    \ Выводим время в формате ЧЧ:ММ:СС
    ROT .2DIGITS  \ час
    ." :"
    ROT .2DIGITS  \ минута
    ." :"
    .2DIGITS      \ секунда
;
